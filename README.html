<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tin</title>
<link rel="stylesheet" href="https://stackedit.io/res-min/themes/base.css" />
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body><div class="container"><h1 id="tin">TIN</h1>

<p>Celem zadania jest implementacja serwera, umożliwiającego wykonywanie mapowań połączeń pomiędzy ruterami. Zachowanie algorytmu traceroutingu zgodne jest z działaniem programu tracert ze środowiska MS Windows - program wysyła komunikaty ICMP ECHO_REQUEST z kolejnymi wartościami pola TTL i oczekuje komunikatów ICMP TIME_EXCEEDED. Zlecenie wykonania zadania oraz odbiór wyników wykorzystuje połączenie z wykorzystaniem protokołu HTTP i notacji/składni JSON. Program będzie zrealizowany w środowisku Linuks.</p>



<h2 id="podział-na-moduły">Podział na moduły</h2>



<h4 id="moduł-1-kontakt-poprzez-protokół-http-za-pomocą-jsonów">Moduł 1: Kontakt poprzez protokół HTTP za pomocą JSON’ów:</h4>

<p>Odbiera prośby spoza serwera oraz zwraca dane.</p>



<h4 id="moduł-2-tracer">Moduł 2: Tracer:</h4>

<p>Na podstawie żądań uzyskanych z <b>Modułu 3.</b> buduje pakiety i na ich bazie wykonuje zadanie traceroutingu.</p>



<h4 id="moduł-3-centrum-kontroli-danych">Moduł 3: Centrum kontroli danych:</h4>

<p>Obsługuje dwie kolejki żądań: od <b> Modułu 1.</b> i <b> Modułu 2.</b> (może również żądać wykonywania zadań). Na ich podstawie dokonuje parsowania danych do formy rozumianej przez konkretne moduły i przesyłania ich do bazy lub wyciągania z bazy w celu dalszej obróbki i zwrócenia żądanych danych.</p>



<div class="sequence-diagram"><svg height="723" version="1.1" width="861.0703125" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow: hidden; position: relative; top: -0.015625px;"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with Raphaël 2.1.2</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><marker id="raphael-marker-endblock55-obj489" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj492" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj495" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj498" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj501" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj504" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj509" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj512" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj515" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj518" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj521" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj524" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj529" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj532" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj535" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="#000" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker></defs><rect x="10" y="20" width="55.21875" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="19.984375" y="30" width="35.21875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="37.609375" y="39.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Świat</tspan></text><rect x="10" y="664" width="55.21875" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="19.984375" y="674" width="35.21875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="37.609375" y="683.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Świat</tspan></text><path fill="none" stroke="#000000" d="M37.609375,59L37.609375,664" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="190.9921875" y="20" width="69.921875" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="200.984375" y="30" width="49.921875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="225.953125" y="39.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Moduł 1</tspan></text><rect x="190.9921875" y="664" width="69.921875" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="200.984375" y="674" width="49.921875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="225.953125" y="683.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Moduł 1</tspan></text><path fill="none" stroke="#000000" d="M225.953125,59L225.953125,664" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="384.8515625" y="20" width="69.921875" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="394.84375" y="30" width="49.921875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="419.8125" y="39.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Moduł 3</tspan></text><rect x="384.8515625" y="664" width="69.921875" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="394.84375" y="674" width="49.921875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="419.8125" y="683.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Moduł 3</tspan></text><path fill="none" stroke="#000000" d="M419.8125,59L419.8125,664" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="697.5703125" y="20" width="43.578125" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="707.5625" y="30" width="23.578125" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="719.359375" y="39.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Plik</tspan></text><rect x="697.5703125" y="664" width="43.578125" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="707.5625" y="674" width="23.578125" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="719.359375" y="683.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Plik</tspan></text><path fill="none" stroke="#000000" d="M719.359375,59L719.359375,664" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="761.1484375" y="20" width="69.921875" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="771.140625" y="30" width="49.921875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="796.109375" y="39.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Moduł 2</tspan></text><rect x="761.1484375" y="664" width="69.921875" height="39" rx="0" ry="0" fill="none" stroke="#000000" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="771.140625" y="674" width="49.921875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="796.109375" y="683.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Moduł 2</tspan></text><path fill="none" stroke="#000000" d="M796.109375,59L796.109375,664" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="47.59375" y="74.5" width="168.34375" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="131.78125" y="84" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">JSON(prośba o traceroute)</tspan></text><path fill="none" stroke="#000000" d="M37.609375,98C37.609375,98,191.08792324503884,98,220.95179115307008,98" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj489)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="88.515625" y="113.5" width="86.515625" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="131.78125" y="123" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">JSON(nr. zad)</tspan></text><path fill="none" stroke="#000000" d="M225.953125,137C225.953125,137,72.47457675496116,137,42.610708846929924,137" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj492)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="240.84375" y="152.5" width="164.046875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="322.8828125" y="162" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Object(adresy IP + nr. zad)</tspan></text><path fill="none" stroke="#000000" d="M225.953125,176C225.953125,176,384.43938257335685,176,414.81333574598506,176" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj495)" stroke-dasharray="6,2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="501.046875" y="191.5" width="137.0625" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="569.5859375" y="201" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Create(Name: nr. zad)</tspan></text><path fill="none" stroke="#000000" d="M419.8125,215C419.8125,215,675.2606552157085,215,714.3636809286601,215" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj498)" stroke-dasharray="6,2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="525.921875" y="230.5" width="164.046875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="607.9609375" y="240" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Object(adresy IP + nr. zad)</tspan></text><path fill="none" stroke="#000000" d="M419.8125,254C419.8125,254,746.5921743540093,254,791.1095225692284,254" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj501)" stroke-dasharray="6,2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="500.890625" y="269.5" width="214.109375" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="607.9609375" y="279" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Object(Wynik tracerouta + nr. zad)</tspan></text><path fill="none" stroke="#000000" d="M796.109375,293C796.109375,293,469.32970064599067,293,424.8123524307716,293" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj504)" stroke-dasharray="6,2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="444.796875" y="313" width="122.96875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="506.296875" y="322.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Parsowanie danych</tspan></text><path fill="none" stroke="#000000" d="M419.8125,308L439.8125,308" stroke-width="2" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><path fill="none" stroke="#000000" d="M439.8125,308L439.8125,342" stroke-width="2" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><path fill="none" stroke="#000000" d="M439.8125,342C439.8125,342,430.7316131591797,342,424.8077533841133,342" stroke-width="2" stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj509)" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="429.796875" y="347.5" width="279.546875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="569.5859375" y="357" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Save(Name: nr. zad; Data: dane z tracerouta)</tspan></text><path fill="none" stroke="#000000" d="M419.8125,371C419.8125,371,675.2606552157085,371,714.3636809286601,371" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj512)" stroke-dasharray="6,2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="88.515625" y="386.5" width="86.515625" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="131.78125" y="396" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">JSON(nr. zad)</tspan></text><path fill="none" stroke="#000000" d="M37.609375,410C37.609375,410,191.08792324503884,410,220.95179115307008,410" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj515)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="276.375" y="425.5" width="92.984375" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="322.8828125" y="435" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Object(nr. zad)</tspan></text><path fill="none" stroke="#000000" d="M225.953125,449C225.953125,449,384.43938257335685,449,414.81333574598506,449" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj518)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="502.296875" y="464.5" width="134.546875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="569.5859375" y="474" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Open(Nazwa: nr. zad)</tspan></text><path fill="none" stroke="#000000" d="M419.8125,488C419.8125,488,675.2606552157085,488,714.3636809286601,488" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj521)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="467.34375" y="503.5" width="204.453125" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="569.5859375" y="513" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">GetData(Data:dane z tracerouta)</tspan></text><path fill="none" stroke="#000000" d="M719.359375,527C719.359375,527,463.91121978429146,527,424.80819407134,527" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj524)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="444.796875" y="547" width="122.96875" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="506.296875" y="556.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Parsowanie danych</tspan></text><path fill="none" stroke="#000000" d="M419.8125,542L439.8125,542" stroke-width="2" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><path fill="none" stroke="#000000" d="M439.8125,542L439.8125,576" stroke-width="2" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><path fill="none" stroke="#000000" d="M439.8125,576C439.8125,576,430.7316131591797,576,424.8077533841133,576" stroke-width="2" stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj529)" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="235.9375" y="581.5" width="173.859375" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="322.8828125" y="591" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Object("dane sparsowane")</tspan></text><path fill="none" stroke="#000000" d="M419.8125,605C419.8125,605,261.32624242664315,605,230.95228925401494,605" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj532)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="93.96875" y="620.5" width="75.609375" height="19" rx="0" ry="0" fill="#ffffff" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="131.78125" y="630" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: 'Andale Mono', monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">JSON(dane)</tspan></text><path fill="none" stroke="#000000" d="M225.953125,644C225.953125,644,72.47457675496116,644,42.610708846929924,644" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj535)" stroke-dasharray="0" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path></svg></div>

<h2 id="struktury-danych">Struktury danych</h2>



<h4 id="json">JSON:</h4>

<p>Żądanie wykonania tracerouta:</p>



<pre class="prettyprint"><code class=" hljs r">{
    addresses: [
        {
            address: ip
        },
        {<span class="hljs-keyword">...</span>}]`
}</code></pre>

<p>Zwrotka z numerem zadania:</p>



<pre class="prettyprint"><code class=" hljs css"><span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">task</span>:<span class="hljs-value"> nr
</span></span></span>}</code></pre>

<p>Zapytanie o dane z numeru zadania:</p>



<pre class="prettyprint"><code class=" hljs r">{
    tasks:[
        {
            task: nr
        },
        {<span class="hljs-keyword">...</span>}]
}</code></pre>

<p>Dane z zadania:</p>



<pre class="prettyprint"><code class=" hljs r">{
    tasks:[
    {
    task: nr,
    addresses:[
        {
            address: ip,
        },
        {<span class="hljs-keyword">...</span>}]
    },
    {<span class="hljs-keyword">...</span>}
    ]
}</code></pre>



<h4 id="obiekty">Obiekty:</h4>

<p>Zadanie:</p>



<pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Task</span>:</span>
    ip[]
    task_number</code></pre>

<p>Wynik zadania(z Modułu 2):</p>



<pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TaskResult</span>:</span>
    task_number
    addresses[traceroute[]] /<span class="hljs-regexp">/tablica tablic (wiele adresow ip)</span></code></pre>

<p>Adresy:</p>



<pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Addresses</span>:</span>
    <span class="hljs-symbol">taks:</span> nr
    addresses[traceroute[]] /<span class="hljs-regexp">/tablica tablic (wiele adresow ip)</span></code></pre>

<p>Sparsowane dane:</p>



<pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParsedData</span>:</span>
    <span class="hljs-constant">Addresses</span>[]</code></pre>



<h4 id="system-plików">System plików</h4>

<p>Zadania:</p>



<pre class="prettyprint"><code class=" hljs r">Nazwa: nr zadania
Treść: ip; ip; ip; ip; ip;\n ip; ip; ip; \n ip; ip; ip; ip; \n <span class="hljs-keyword">...</span></code></pre>



<h2 id="szczegółowy-opis-działania-modułów">Szczegółowy opis działania modułów</h2>



<h3 id="moduł-1">Moduł 1</h3>

<p>Moduł 1 odbiera JSON’y, przesyłane od kilenta za pomocą protokołu HTTP(POST). Następnie w zależności od danego żądania będzie wykonywał jedno z dwóch zadań.</p>



<h4 id="dotraceroute">/doTraceroute</h4>

<p>Moduł odbiera JSON’a z danymi do tracerouta (struktura powyżej), przekształca go do obiektu, nadaje unikalny numer zadania (który zwraca również w postaci JSON’a), a następnie umieszcza obiekt w kolejce oczekujących.</p>



<h4 id="getdata">/getData</h4>

<p>Moduł odbiera JSON’a z numerem zadania. Składa żądanie do Modułu 3. o dane o zadanym numerze. Jeśli w zwrocie dostaje dane, to parsuje je do JSON’a którego zwraca. Jeśli nie, zwraca odpowiedni kod błędu.</p>

<p>Moduł 1 działa na “jednym” samoklonującym się wątku, który w sytuacji odebrania żądania tworzy swojego klona, a sam zajmuje się wykonaniem zadanego zadania.</p>



<h3 id="moduł-2">Moduł 2</h3>

<p>Moduł nr 2 wykonuje właściwą operację traceroute pakietów. Podzielony jest na trzy zasadnicze elementy: generator pakietów (działający w wątku wysyłającym), wątek wysyłający pakiety oraz wątek odbierający pakiety i rozdzielający odebrane dane według odpowiednich pól nagłówka odebranego komunikatu. Wykorzystuje protokół ICMP - internetowy protokół komunikatów kontrolnych. <br>
Moduł wysyła komunikaty ICMP ECHO_REQUEST (znane np. z programu ping) z kolejnymi wartościami pola TTL i oczekuje komunikatów TIME_EXCEEDED (przekroczony TTL) oraz ECHO_REPLY (pakiet dotarł do celu, koniec trasy).</p>



<h4 id="generator-pakietów">Generator pakietów:</h4>

<p>Ze względu na stosowanie protokołu ICMP zastosowany musi być tzw. “raw socket”, czyli gniazda umożliwiające wysyłkę i odbiór pakietów IP bez informacji warstwy transportu. Zastosowanie tego typu gniazd wymagana ręcznego tworzenia pakietów do wysłania, odpowiedzialny za to będzie obiekt klasy Generator pakietów. Tworzy on pakiety IP o zadanym Adresie docelowym oraz TTL (Time-To-Live), w którym zawarty będzie pakiet protokołu ICMP o typie komunikatu ECHO_REQUEST i określonych wartościach pól Sequence i Identifier. Identifier to całkowitoliczbowy identyfikator konkretnej śledzonej trasy, a Sequence to TTL pakietu.</p>



<h4 id="budowa-pakietu-icmp-echo">Budowa pakietu ICMP Echo:</h4>

<p>Nagłówek protokołu IP będzie budowany automatycznie, wykorzystując flagę IP_HDRINCL z API raw socket. <br>
Nagłówek ICMP oraz dane będą budowane ręcznie w następujący sposób: <br>
- Typ - typ wysyłanego komunikatu ICMP w naszym przypadku 08 - Echo request(1 bajt) <br>
- Kod - podtyp wiadomości, naśladując MS Windows, program wpisuje kod 00 (1 bajt) <br>
- Suma kontrolna - wyliczana na podstawie nagłówka pakietu ICMP oraz danych (2 bajty) <br>
- Identyfikator - reprezentujący numer zadania, używany do identyfikacji odpowiadających pakietów (2 bajty) <br>
- Numer sekwencji - reprezentujący TTL, jak identyfikator używany do identyfikacji odpowiadających pakietów (2 bajty)</p>

<p>Dane: 64 bajty zer.</p>



<h4 id="wątek-wysyłający">Wątek wysyłający</h4>

<p>Przyjmuje zadania od Modułu 3., generuje za pomocą Generatora pakiety do wysłania, tworzy gniazdo i wysyła pakiety. Zapisuje informacje o wysłanym pakiecie (w tym czas wysłania) do kolejki, z której odbierze tę strukturę wątek odbierający.</p>



<h4 id="wątek-odbierający">Wątek odbierający</h4>

<p>Zastosowanie ICMP wraz z “raw socket” wymusza utworzenie jednego wątku odbierającego przez brak rozróżnienia portów. Jego zadaniem będzie odbieranie wszystkich pakietów ICMP i ich interpretacja (możemy np. otrzymać pakiet zupełnie niezwiązany z zadaniem).</p>



<h4 id="komunikacja-z-modułem-3">Komunikacja z Modułem 3.</h4>

<p>Kolejka std::queue zabezpieczona semaforem, przechowująca struktury z adresami do traceroutingu (Moduł 2. &lt;– Moduł 3.). <br>
Kolejka std::queue zabezpieczona semaforem, przechowująca wyznaczone trasy (Moduł 2. –&gt; Moduł 3.). <br>
Sygnał SIGUSR2 nadawany przez Moduł 3., pobudzający do działania wątki Modułu 2. <br>
Sygnał SIGUSR2 nadawany przez Moduł 2. po wykonaniu zadania traceroutingu, informujący Moduł 3. o danych w kolejce wynikowej.</p>



<h4 id="synchronizacja-pomiędzy-wątkami-odbierającym-i-wysyłającym">Synchronizacja pomiędzy wątkami odbierającym i wysyłającym</h4>

<p>Wątki współdzielą kolejkę typu std::queue, zabezpieczoną semaforem, przeznaczoną do dostarczania wiedzy do wątku odbierającego o wysłanych pakietach. Kolejka ta przechowuje struktury zawierające kompletny pakiet oraz wyodrębione najważniejsze informacje na jego temat: wartości pól Identifier, Sequence i czas wysłania. <br>
Sygnał SIGUSR1 to polecenie “kontynuuj wysyłanie pakietów”, wydawane wątkowi wysyłającemu przez wątek odbierający po odebraniu pakietu, zidentyfikowanego jako odpowiedź na pakiet wysłany pobrany z kolejki. <br>
Aby uniknąć aktywnego oczekiwania na komunikaty (np. “zawieszając” się na zmiennej współdzielonej), wątki odbierają sygnały poprzez wykorzystanie funkcji pselect(), która poza korzystaniem ze standardowych deskryptorów gniazd, powiadamia również w razie wystąpienia jednego z sygnałów.</p>



<h4 id="algorytm-traceroute">Algorytm traceroute:</h4>

<ol>
<li><p>Wątek wysyłający przyjmuje od Modułu nr 3 dane, określające, jaka trasa ma być wyznaczona.</p></li>
<li><p>n = 1.</p></li>
<li><p>Wygeneruj za pomocą generatora pakiet o TTL = n, Identifier = numer zadania, Sequence = n, a następnie wyślij je i poinformuj wątek odbierający o wysłanych pakietach poprzez wstawienie pierwszego z nich i jego najważniejszych danych do współdzielonej kolejki.</p></li>
<li><p>Czekaj na sygnał od wątku odbierającego (funkcja pselect() o określonej wartości timeout, powodującej automatyczne przejście do następnego zadania). Jeśli mamy kontynuować wysyłanie pakietów, n += 1 i wróć do punktu 4.</p></li>
<li><p>Po zakończeniu traceroutingu wątek odbierający przesyła do Modułu nr 3 wyznaczoną trasę lub jej fragment/kod błędu (struktura składająca się z nagłówka oraz listy adresów). Jeśli w kolejce są kolejne trasy do wyznaczania, rozpoczynamy pracę.</p></li>
</ol>



<h4 id="parametry-dotyczące-modułu-2">Parametry dotyczące Modułu 2.:</h4>

<p>Parametry przechowywane są w standardowym tekstowym pliku konfiguracyjnym Module2.conf - jeden parametr odpowiadający jednej linii pliku.</p>

<p>MAX_TTL - domyślna wartość maksymalnego czasu życia pakietu.</p>

<p>MAX_PACKETS_PER_TTL - domyślna ilość pakietów wysyłanych do danego adresu z określoną wartościa TTL. Ze względu na brak gwarancji dostarczenia.</p>

<p>FREQ - częstotliwość wysyłania pakietów. Część zapór ogniowych może wykryć dużą ilość pakietów ICMP i zablokować dalszy ruch.</p>

<p>TIMEOUT - maksymalny czas oczekiwania na odpowiedź.</p>



<h3 id="moduł-3">Moduł 3</h3>

<p>Moduł trzy zarządza wszelkim ruchem na serwerze. Obsługuje i wysyła żądania do wszystkich pozostałych modułów.</p>



<h4 id="interakcja-z-modułem-1">Interakcja z Modułem 1.:</h4>

<ol>
<li>Odbiór danych do tracerouta.</li>
<li>Odbiór żądania danych wynikowych: <br>
a. Brak gotowych. <br>
b. Sparsowanie danych i przesłanie do Modułu 1.</li>
</ol>



<h4 id="interakcja-z-modułem-2">Interakcja z Modułem 2.:</h4>

<ol>
<li>Wstawienie do kolejki danych do tracerouta.</li>
<li>Nadanie sygnału SIGUSR2 do Modułu 2. w celu pobudzenia wątków tego modułu.</li>
<li>Odebranie sygnału SIGUSR2 przez odpowiedni wątek od Modułu 2., informującego o danych z tracerouta.</li>
<li>Odbiór z kolejki danych z tracerouta i sparsowanie ich.</li>
</ol>



<h4 id="interakcja-z-systemem-plików">Interakcja z systemem plików:</h4>

<ol>
<li>Dodanie nowego zadania (utwórz plik z dopiskiem ze niegotowy).</li>
<li>Dodanie danych z zadania (otworzenie, zapis).</li>
<li>Wyciągnięcie informacji o stanie zadania: <br>
a. Nieskończone. <br>
b. Gotowe - parsowanie danych.</li>
</ol>

<p>Moduł będzie działał na dwóch wątkach. <br>
Pierwszy będzie cyklicznie sprawdzał, czy w kolejkach nie ma zadań do wykonania, a następnie w zależności od sytuacji wykonywał odpowiednie zadania, takie jak: parsowanie, zapisywanie do plików czy przesyłanie danych między kolejkami. <br>
Drugi będzie przeznaczony tylko i wyłącznie do sytuacji związanych z żądaniami wyników, jako że takie działania mają priorytet (klient oczekuję na reakcję serwera). Będzie on sprawdzał gotowość zadania i w zależności od sytuacji zwracał informację o tym, że zadanie jest jeszcze nie skończone lub parsował dane z plików do wersji obiektowej i przesyłał z powrotem do Modułu 1.</p>

<blockquote>
  <p>Written with <a href="https://stackedit.io/">StackEdit</a>.</p>
</blockquote></div></body>
</html>